<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<title>WikiScroll ‚Äî Discover Random Wikipedia Articles in a TikTok-Style Feed</title>
<meta name="description" content="Swipe through random Wikipedia and Wikivoyage articles in a beautiful, infinite feed. Free, no ads, no tracking. 14 languages, offline support, topic filtering. Like TikTok for learning.">
<meta name="keywords" content="Wikipedia reader, Wikivoyage, infinite scroll, random Wikipedia articles, learn something new, TikTok for learning, Wikipedia app, educational app, knowledge discovery, free learning, random knowledge, Wikipedia browser, travel articles">
<meta name="author" content="WikiScroll">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<link rel="canonical" href="https://wikiscroll.com/">
<meta name="theme-color" content="#07070d" media="(prefers-color-scheme: dark)">
<meta name="theme-color" content="#f4f3ef" media="(prefers-color-scheme: light)">
<meta name="color-scheme" content="dark light">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="WikiScroll">
<meta name="application-name" content="WikiScroll">
<meta name="mobile-web-app-capable" content="yes">
<meta name="format-detection" content="telephone=no">
<link rel="manifest" href="/manifest.json">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png">

<link rel="alternate" hreflang="en" href="https://wikiscroll.com/">
<link rel="alternate" hreflang="es" href="https://wikiscroll.com/?lang=es">
<link rel="alternate" hreflang="fr" href="https://wikiscroll.com/?lang=fr">
<link rel="alternate" hreflang="de" href="https://wikiscroll.com/?lang=de">
<link rel="alternate" hreflang="ja" href="https://wikiscroll.com/?lang=ja">
<link rel="alternate" hreflang="zh" href="https://wikiscroll.com/?lang=zh">
<link rel="alternate" hreflang="x-default" href="https://wikiscroll.com/">

<meta property="og:type" content="website">
<meta property="og:url" content="https://wikiscroll.com/">
<meta property="og:title" content="WikiScroll ‚Äî Random Wikipedia Articles, Beautifully Delivered">
<meta property="og:description" content="Swipe through random Wikipedia and Wikivoyage articles in a beautiful, TikTok-style feed. Free, private, works offline. Learn something new every scroll.">
<meta property="og:image" content="https://wikiscroll.com/og-image.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="WikiScroll ‚Äî Discover Wikipedia like never before">
<meta property="og:site_name" content="WikiScroll">
<meta property="og:locale" content="en_US">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="WikiScroll ‚Äî Random Wikipedia Articles, Beautifully Delivered">
<meta name="twitter:description" content="Swipe through random Wikipedia and Wikivoyage articles in a beautiful feed. Free, no ads, no tracking. Like TikTok for learning.">
<meta name="twitter:image" content="https://wikiscroll.com/og-image.png">
<meta name="twitter:image:alt" content="WikiScroll ‚Äî Discover Wikipedia like never before">
<meta name="twitter:creator" content="@wikiscroll">

<meta name="apple-itunes-app" content="app-argument=https://wikiscroll.com/">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "WikiScroll",
  "alternateName": "WikiScroll ‚Äî Random Wikipedia Reader",
  "url": "https://wikiscroll.com",
  "description": "Infinite scrolling through Wikipedia and Wikivoyage articles in multiple languages. Discover random knowledge in a beautiful, swipeable feed ‚Äî like TikTok for learning.",
  "applicationCategory": "EducationalApplication",
  "operatingSystem": "Any",
  "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
  "author": { "@type": "Organization", "name": "WikiScroll", "url": "https://wikiscroll.com" }
}
</script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=DM+Sans:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" integrity="sha512-h9FcoyWjHcOcmEVkxOfTLnmZFWIH0iZhZT1H2TbOq55xssQGEJHEaIm+PgoUaZbRvQTNTluNOEfb1ZRy6D3bA==" crossorigin="anonymous" referrerpolicy="no-referrer">
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js" integrity="sha512-puJW3E/qXDqYp9IfhAI54BJEaWIfloJ7JWs7OeD5i6ruC9JZL1gERT1wjfqERvhDMj2QIo7uo2djIo40UWE8w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<style>
:root{
  --w1:#667eea;--w2:#764ba2;
  --h1:#11998e;--h2:#38ef7d;
  --glass:rgba(10,10,18,.87);
  --border:rgba(255,255,255,.09);
  --dim:rgba(255,255,255,.48);
  --vh:100vh;
}
@supports (height:100dvh) { :root{--vh:100dvh;} }
*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;overflow:hidden;overscroll-behavior:none;-webkit-overflow-scrolling:touch;}
body{font-family:'DM Sans',sans-serif;background:#07070d;color:#fff;}

/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
.hdr{
  position:fixed;top:0;left:0;right:0;z-index:300;
  display:grid;grid-template-columns:1fr auto 1fr;
  align-items:center;gap:8px;
  padding:max(13px,env(safe-area-inset-top)) 16px 13px;
  background:linear-gradient(to bottom,rgba(7,7,13,.97) 60%,transparent);
}
.hdr-left,.hdr-mid,.hdr-right{display:flex;align-items:center;}
.hdr-left{justify-content:flex-start;}
.hdr-mid{justify-content:center;}
.hdr-right{justify-content:flex-end;gap:7px;}
.logo{
  font-family:'Syne',sans-serif;font-size:22px;font-weight:800;letter-spacing:-1px;
  background:linear-gradient(135deg,var(--w1),var(--w2));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  white-space:nowrap;
}
body.how .logo{
  background:linear-gradient(135deg,var(--h1),var(--h2));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}

/* ‚îÄ‚îÄ TOGGLE ‚îÄ‚îÄ */
.toggle{
  display:flex;background:rgba(255,255,255,.06);
  border:1px solid var(--border);border-radius:50px;padding:3px;gap:2px;
}
.tbtn{
  font-family:'Syne',sans-serif;font-size:12px;font-weight:700;
  padding:6px 14px;border-radius:50px;border:none;cursor:pointer;
  background:transparent;color:var(--dim);transition:all .22s;white-space:nowrap;
}
.tbtn.on{color:#fff;}
.tbtn.won{background:linear-gradient(135deg,var(--w1),var(--w2));box-shadow:0 2px 12px rgba(102,126,234,.4);}
.tbtn.hon{background:linear-gradient(135deg,var(--h1),var(--h2));box-shadow:0 2px 12px rgba(56,239,125,.25);}

/* ‚îÄ‚îÄ PILLS / BADGES ‚îÄ‚îÄ */
.pill{
  display:flex;align-items:center;gap:6px;padding:6px 13px;height:32px;
  background:rgba(255,255,255,.07);border:1px solid var(--border);border-radius:50px;
  color:#fff;cursor:pointer;font-size:12px;font-weight:500;
  transition:background .2s;white-space:nowrap;font-family:'DM Sans',sans-serif;flex-shrink:0;
}
.pill:hover{background:rgba(255,255,255,.13);}
.badge{font-size:10px;font-weight:700;padding:1px 5px;border-radius:20px;background:var(--w2);line-height:1.4;}
body.how .badge{background:var(--h1);}
.topic-badge{background:var(--w1);}

/* ‚îÄ‚îÄ DESKTOP LANG DROPDOWN ‚îÄ‚îÄ */
.lang-wrap{position:relative;}
.lang-dd{
  position:absolute;top:calc(100% + 8px);right:0;
  background:rgba(12,12,20,.98);border:1px solid var(--border);
  border-radius:16px;padding:6px;min-width:185px;
  display:none;max-height:360px;overflow-y:auto;
  box-shadow:0 20px 60px rgba(0,0,0,.7);z-index:400;
  scrollbar-width:thin;scrollbar-color:rgba(255,255,255,.08) transparent;
}
.lang-dd.open{display:block;}
.lopt{
  padding:9px 12px;cursor:pointer;border-radius:10px;
  display:flex;align-items:center;gap:9px;
  font-size:13px;color:rgba(255,255,255,.8);transition:background .15s;
}
.lopt:hover,.lopt.sel{background:rgba(255,255,255,.08);}

/* ‚îÄ‚îÄ HAMBURGER BTN ‚îÄ‚îÄ */
.burger-btn{
  display:none;align-items:center;justify-content:center;
  width:36px;height:36px;border-radius:50%;
  background:rgba(255,255,255,.07);border:1px solid var(--border);
  cursor:pointer;flex-shrink:0;position:relative;transition:background .2s;
}
.burger-btn:hover{background:rgba(255,255,255,.13);}
.burger-btn svg{width:18px;height:18px;display:block;}
.burger-dot{
  position:absolute;top:-3px;right:-3px;width:8px;height:8px;
  border-radius:50%;background:var(--w1);display:none;
}
body.how .burger-dot{background:var(--h1);}

/* ‚îÄ‚îÄ BURGER MENU ‚îÄ‚îÄ */
.burger-backdrop{
  position:fixed;inset:0;z-index:298;
  background:rgba(0,0,0,.4);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
  opacity:0;pointer-events:none;
  transition:opacity .3s cubic-bezier(.4,0,.2,1);
}
.burger-backdrop.open{opacity:1;pointer-events:auto;}
.burger-menu{
  position:fixed;top:0;left:0;right:0;z-index:299;
  background:rgba(7,7,13,.99);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);
  border-bottom:1px solid var(--border);
  max-height:0;overflow:hidden;
  transition:max-height .3s cubic-bezier(.4,0,.2,1);
}
.burger-menu.open{max-height:100dvh;overflow-y:auto;}
.burger-inner{
  padding:calc(max(13px,env(safe-area-inset-top)) + 60px) 18px calc(18px + env(safe-area-inset-bottom));
}
.burger-row{
  display:flex;align-items:center;justify-content:space-between;
  padding:13px 0;border-bottom:1px solid var(--border);
}
.burger-row:last-child{border-bottom:none;padding-bottom:0;}
.burger-row-label{display:flex;align-items:center;gap:10px;color:rgba(255,255,255,.75);font-size:14px;font-weight:500;}
.burger-row-label .ico{font-size:18px;line-height:1;}
.burger-row-sub{font-size:11px;color:var(--dim);font-weight:400;margin-top:2px;}
.burger-action{
  display:flex;align-items:center;gap:7px;padding:7px 14px;border-radius:50px;
  background:rgba(255,255,255,.07);border:1px solid var(--border);
  color:#fff;cursor:pointer;font-size:12px;font-weight:500;
  font-family:'DM Sans',sans-serif;transition:background .2s;white-space:nowrap;
}
.burger-action:hover{background:rgba(255,255,255,.13);}
.burger-action.active{background:rgba(102,126,234,.18);border-color:rgba(102,126,234,.35);color:#a5b4fc;}

/* ‚îÄ‚îÄ TOGGLE SWITCH ‚îÄ‚îÄ */
.toggle-sw{
  width:44px;height:24px;border-radius:12px;border:none;
  background:rgba(255,255,255,.15);cursor:pointer;position:relative;
  transition:background .2s;flex-shrink:0;
}
.toggle-sw::after{
  content:'';position:absolute;top:2px;left:2px;
  width:20px;height:20px;border-radius:50%;
  background:#fff;transition:transform .2s;
  box-shadow:0 1px 4px rgba(0,0,0,.3);
}
.toggle-sw.on{background:var(--w1);}
body.how .toggle-sw.on{background:var(--h1);}
.toggle-sw.on::after{transform:translateX(20px);}

/* ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ */
.modal-overlay{
  position:fixed;inset:0;z-index:500;display:none;
  align-items:center;justify-content:center;
  background:rgba(0,0,0,.6);backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);
}
.modal-overlay.open{display:flex;}
.modal{
  width:min(420px,88vw);background:rgba(12,12,20,.98);
  border:1px solid var(--border);border-radius:24px;padding:32px;
  box-shadow:0 30px 80px rgba(0,0,0,.7);text-align:center;position:relative;
  animation:mshow .22s ease;
}
@keyframes mshow{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
.modal-close{
  position:absolute;top:16px;right:18px;font-size:18px;cursor:pointer;
  background:none;border:none;color:var(--dim);transition:color .2s;
}
.modal-close:hover{color:#fff;}

/* ‚îÄ‚îÄ FEED / CARDS ‚îÄ‚îÄ */
.feed{
  height:var(--vh);overflow-y:scroll;scroll-snap-type:y mandatory;-webkit-scroll-snap-type:y mandatory;
  scrollbar-width:none;-ms-overflow-style:none;
  touch-action:pan-y;-webkit-overflow-scrolling:touch;
  outline:none;
}
.feed::-webkit-scrollbar{display:none;}
.card{
  height:var(--vh);scroll-snap-align:start;position:relative;
  display:flex;align-items:center;justify-content:center;
  background:#07070d;overflow:hidden;
  will-change:transform,opacity;transform:translateZ(0);
  content-visibility:auto;contain-intrinsic-size:100vw var(--vh);
}
.cbg{position:absolute;inset:0;z-index:0;}
.cbg img{width:100%;height:100%;object-fit:cover;opacity:.45;filter:blur(28px) saturate(1.6);transform:scale(1.12) translateZ(0);}
.cveil{
  position:absolute;inset:0;
  background:rgba(7,7,13,.45),
    radial-gradient(ellipse at 30% 30%,rgba(102,126,234,.1) 0%,transparent 60%),
    radial-gradient(ellipse at 75% 75%,rgba(118,75,162,.07) 0%,transparent 55%);
}
.card.how .cveil{
  background:rgba(7,7,13,.45),
    radial-gradient(ellipse at 30% 30%,rgba(17,153,142,.1) 0%,transparent 60%),
    radial-gradient(ellipse at 75% 75%,rgba(56,239,125,.06) 0%,transparent 55%);
}

/* ‚îÄ‚îÄ SWIPE INDICATORS ‚îÄ‚îÄ */
.swipe-ind{
  position:absolute;z-index:2;top:50%;transform:translateY(-50%);
  font-family:'Syne',sans-serif;font-weight:800;font-size:22px;letter-spacing:.5px;
  padding:12px 22px;border-radius:16px;border:3px solid;
  opacity:0;pointer-events:none;transition:opacity .08s;
  text-shadow:0 2px 8px rgba(0,0,0,.5);
  background:rgba(0,0,0,.25);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
}
.like-ind{left:22px;color:#4ade80;border-color:#4ade80;transform:translateY(-50%) rotate(-14deg);}
.skip-ind{right:22px;color:#f87171;border-color:#f87171;transform:translateY(-50%) rotate(14deg);}

/* ‚îÄ‚îÄ PANEL ‚îÄ‚îÄ */
.panel{
  position:relative;z-index:1;width:min(660px,90vw);max-height:74vh;padding:24px;
  background:var(--glass);backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);
  border-radius:26px;border:1px solid var(--border);
  box-shadow:0 30px 80px rgba(0,0,0,.6),inset 0 1px 0 rgba(255,255,255,.05);
  display:flex;flex-direction:column;overflow:hidden;
}
.top-map-btn{
  position:absolute;top:20px;right:20px;
  width:40px;height:40px;border-radius:50%;
  background:rgba(17,153,142,.15);border:1px solid rgba(17,153,142,.3);
  color:#6ee7b7;font-size:18px;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  transition:all .2s;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
}
.top-map-btn:hover{background:rgba(17,153,142,.3);transform:scale(1.05);}
.chip{
  display:inline-flex;align-items:center;gap:5px;
  font-family:'Syne',sans-serif;font-size:10px;font-weight:700;
  letter-spacing:1.1px;text-transform:uppercase;
  padding:3px 10px;border-radius:20px;margin-bottom:14px;width:fit-content;flex-shrink:0;
}
.chip.w{background:rgba(102,126,234,.16);color:#a5b4fc;border:1px solid rgba(102,126,234,.22);}
.chip.h{background:rgba(17,153,142,.15);color:#6ee7b7;border:1px solid rgba(17,153,142,.22);}
.art-img{width:100%;max-height:220px;object-fit:contain;border-radius:16px;margin-bottom:14px;flex-shrink:0;background:rgba(0,0,0,.25);}
.art-title{
  font-family:'Syne',sans-serif;font-size:21px;font-weight:700;
  line-height:1.22;letter-spacing:-.4px;margin-bottom:10px;flex-shrink:0;
  overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;
}
.art-body{
  font-size:14px;line-height:1.65;color:rgba(255,255,255,.73);
  flex-shrink:1;min-height:0;margin-bottom:18px;
  overflow:hidden;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical;
}
.acts{display:flex;gap:10px;flex-shrink:0;flex-wrap:nowrap;margin-top:auto;}
.act{
  display:flex;align-items:center;gap:8px;padding:14px 20px;border-radius:14px;
  border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.07);
  color:#fff;cursor:pointer;font-size:15px;font-weight:500;
  transition:background .25s ease,border-color .25s ease,color .25s ease,opacity .1s;
  white-space:nowrap;font-family:'DM Sans',sans-serif;
  -webkit-tap-highlight-color:transparent;
  overflow:hidden;outline:none;
}
.act:hover{background:rgba(255,255,255,.13);}
.act.liked{background:rgba(239,68,68,.15);border-color:rgba(239,68,68,.35);color:#fca5a5;}
.act.cta{flex:1;justify-content:center;border:none;font-weight:600;background:linear-gradient(135deg,var(--w1),var(--w2));}
.act.cta.hcta{background:linear-gradient(135deg,var(--h1),var(--h2));}

/* ‚îÄ‚îÄ DEPTH SLIDER (Aligned perfectly) ‚îÄ‚îÄ */
.depth-wrap{width:100%;margin-top:6px;position:relative;}
.depth-track{padding:0 10px;}
.depth-slider{
  -webkit-appearance:none;appearance:none;width:100%;height:6px;
  border-radius:3px;background:linear-gradient(90deg,rgba(102,126,234,.3),rgba(251,191,36,.3),rgba(239,68,68,.3));
  outline:none;cursor:pointer;margin:0;
}
.depth-slider::-webkit-slider-thumb{
  -webkit-appearance:none;width:20px;height:20px;border-radius:50%;
  background:#fbbf24;border:3px solid rgba(251,191,36,.5);cursor:pointer;
  box-shadow:0 2px 10px rgba(251,191,36,.35);transition:transform .15s;
}
.depth-slider::-webkit-slider-thumb:hover{transform:scale(1.15);}
.depth-steps{display:flex;justify-content:space-between;margin:10px 10px 0;}
.depth-step{
  flex:0 0 0; display:flex;flex-direction:column;align-items:center;gap:4px;
  font-size:10px;color:var(--dim);transition:color .2s, transform .2s;
  cursor:pointer;text-align:center;
}
.depth-step span{white-space:nowrap;position:absolute;margin-top:10px;}
.depth-step .ds-dot{width:4px;height:4px;border-radius:50%;background:rgba(255,255,255,.15);transition:all .2s;}
.depth-step.active{color:rgba(255,255,255,.85);transform:scale(1.05);}
.depth-step.active .ds-dot{width:6px;height:6px;background:#fbbf24;box-shadow:0 0 6px rgba(251,191,36,.4);}

/* ‚îÄ‚îÄ SETTINGS PANEL (desktop) ‚îÄ‚îÄ */
.sp-backdrop{
  position:fixed;inset:0;z-index:399;
  background:rgba(0,0,0,.4);backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);
  opacity:0;pointer-events:none;
  transition:opacity .32s cubic-bezier(.4,0,.2,1);
}
.sp-backdrop.open{opacity:1;pointer-events:auto;}
.sp{
  position:fixed;top:0;right:-440px;width:420px;height:var(--vh);
  background:rgba(8,8,14,.97);backdrop-filter:blur(22px);-webkit-backdrop-filter:blur(22px);
  border-left:1px solid var(--border);z-index:400;
  transition:right .32s cubic-bezier(.4,0,.2,1);overflow-y:auto;
  padding:max(84px,calc(env(safe-area-inset-top) + 70px)) 22px max(24px,env(safe-area-inset-bottom));
  scrollbar-width:thin;scrollbar-color:rgba(255,255,255,.07) transparent;
}
.sp.open{right:0;}
.sp-hdr{font-family:'Syne',sans-serif;font-size:21px;font-weight:800;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;}
.sp-x{font-size:20px;cursor:pointer;background:none;border:none;color:var(--dim);transition:color .2s;}
.sp-x:hover{color:#fff;}
.sp-section{margin-bottom:22px;}
.sp-section-title{font-family:'Syne',sans-serif;font-size:11px;font-weight:700;color:rgba(255,255,255,.35);letter-spacing:1px;text-transform:uppercase;margin-bottom:10px;}
.sp-row{
  display:flex;align-items:center;justify-content:space-between;
  padding:13px 0;border-bottom:1px solid var(--border);
}
.sp-row:last-child{border-bottom:none;}
.sp-row-label{display:flex;align-items:center;gap:10px;color:rgba(255,255,255,.75);font-size:14px;font-weight:500;flex:1;min-width:0;}
.sp-row-label .ico{font-size:18px;line-height:1;flex-shrink:0;}
.sp-row-sub{font-size:11px;color:var(--dim);font-weight:400;margin-top:2px;}
.sp-about{
  margin-top:8px;padding:20px;border-radius:16px;
  background:rgba(255,255,255,.03);border:1px solid var(--border);
  text-align:center;
}
.sp-about-logo{
  font-family:'Syne',sans-serif;font-size:22px;font-weight:800;letter-spacing:-1px;
  background:linear-gradient(135deg,var(--w1),var(--w2));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  margin-bottom:10px;
}
body.how .sp-about-logo{
  background:linear-gradient(135deg,var(--h1),var(--h2));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}

/* ‚îÄ‚îÄ STREAK (Basic 1.0 logic) ‚îÄ‚îÄ */
.streak-main{display:flex;align-items:center;gap:8px;}
.streak-main .streak-fire{font-size:20px;}
.streak-main .streak-num{font-weight:700;font-size:16px;color:#fbbf24;}
.streak-label{font-size:12px;color:var(--dim);}

/* ‚îÄ‚îÄ KEYBOARD SHORTCUT BAR ‚îÄ‚îÄ */
.kb-bar{
  position:fixed;bottom:0;left:0;right:0;z-index:200;
  display:none;align-items:center;justify-content:center;gap:20px;
  padding:10px 20px max(10px,env(safe-area-inset-bottom));
  background:linear-gradient(to top,rgba(7,7,13,.95) 60%,transparent);
  opacity:0;transition:opacity .3s;pointer-events:none;
}
.kb-bar.show{opacity:1;}
.kb-hint{display:flex;align-items:center;gap:6px;font-size:11px;color:rgba(255,255,255,.35);}
.kb-key{
  display:inline-flex;align-items:center;justify-content:center;
  min-width:22px;height:20px;padding:0 5px;
  border-radius:5px;border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.06);
  font-family:'DM Sans',sans-serif;font-size:10px;font-weight:600;
  color:rgba(255,255,255,.5);letter-spacing:.3px;
}
@media(min-width:601px){.kb-bar{display:flex;}}

/* ‚îÄ‚îÄ MAP EXPLORER ‚îÄ‚îÄ */
.map-overlay{
  position:fixed;inset:0;z-index:750;
  background:rgba(0,0,0,0);pointer-events:none;visibility:hidden;
  transition:background .3s ease, visibility 0s .3s;
}
.map-overlay.open{
  background:rgba(0,0,0,.92);pointer-events:auto;visibility:visible;
  transition:background .3s ease, visibility 0s 0s;
}
.map-container{
  position:absolute;inset:60px 16px 16px;
  border-radius:20px;overflow:hidden;
  opacity:0;transform:translateY(20px) scale(.97);
  transition:opacity .35s ease .05s, transform .35s cubic-bezier(.4,0,.2,1) .05s;
  box-shadow:0 20px 60px rgba(0,0,0,.6);
}
.map-overlay.open .map-container{opacity:1;transform:translateY(0) scale(1);}
.map-container #mapCanvas{width:100%;height:100%;z-index:0;}
.map-hdr{
  position:absolute;top:0;left:0;right:0;z-index:10;
  display:flex;align-items:center;justify-content:space-between;
  padding:16px 20px;
  background:linear-gradient(to bottom,rgba(0,0,0,.7) 0%,rgba(0,0,0,0) 100%);
}
.map-title{
  font-family:'Syne',sans-serif;font-size:16px;font-weight:700;
  color:#fff;letter-spacing:-.3px;text-shadow:0 2px 8px rgba(0,0,0,.5);
}
.map-close{
  width:36px;height:36px;border-radius:50%;
  background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.15);
  cursor:pointer;color:#fff;font-size:16px;
  display:flex;align-items:center;justify-content:center;
  transition:background .2s;
}

/* ‚îÄ‚îÄ LIGHT THEME (Adjusted no emojis for mode desc) ‚îÄ‚îÄ */
body.light{background:#f4f3ef;color:#1a1a2e;}
body.light .hdr{background:linear-gradient(to bottom,rgba(244,243,239,.97) 60%,transparent);}
body.light .logo{background:linear-gradient(135deg,#4a5ad8,#6b3fa0);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
body.light .card{background:#f4f3ef;}
body.light .panel{background:rgba(255,255,255,.92);border-color:rgba(0,0,0,.08);}
body.light .art-title{color:#1a1a2e;}
body.light .art-body{color:rgba(0,0,0,.55);}
body.light .act{background:rgba(0,0,0,.04);border-color:rgba(0,0,0,.1);color:#333;}
body.light .act.cta{color:#fff;}
body.light .top-map-btn{background:rgba(17,153,142,.1);border-color:rgba(17,153,142,.2);color:#0d8a7f;}
body.light .top-map-btn:hover{background:rgba(17,153,142,.2);}
body.light .burger-menu,.light .burger-backdrop{background:rgba(244,243,239,.99);}
body.light .sp{background:rgba(244,243,239,.97);border-color:rgba(0,0,0,.08);}

/* ‚îÄ‚îÄ SWIPE FLASH (Desktop) ‚îÄ‚îÄ */
.swipe-flash{
  position:absolute;inset:0;z-index:3;pointer-events:none;
  border-radius:0;opacity:0;
  transition:opacity .45s ease-out;
}
.swipe-flash.like{background:radial-gradient(ellipse at center,rgba(74,222,128,.2) 0%,transparent 65%);}
.swipe-flash.skip{background:radial-gradient(ellipse at center,rgba(248,113,113,.18) 0%,transparent 65%);}
.swipe-flash.show{opacity:1;}
.beta-tag{
  display:inline-block;font-size:9px;font-weight:700;letter-spacing:.8px;
  text-transform:uppercase;padding:2px 6px;border-radius:6px;
  background:rgba(251,191,36,.15);color:#fbbf24;border:1px solid rgba(251,191,36,.25);
  vertical-align:middle;margin-left:6px;
}
</style>
</head>
<body>

<header class="hdr">
  <div class="hdr-left"><div class="logo">WikiScroll</div></div>
  <div class="hdr-mid">
    <div class="toggle">
      <button class="tbtn won on" id="wBtn">Wikipedia</button>
      <button class="tbtn" id="hBtn">Wikivoyage</button>
    </div>
  </div>
  <div class="hdr-right">
    <button class="pill" id="settingsBtn"><span>‚öôÔ∏è</span><span>Settings</span></button>
    <button class="burger-btn" id="burgerBtn" title="Menu">
      <span class="burger-dot" id="burgerDot"></span>
      <svg viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round">
        <line x1="2" y1="4.5" x2="16" y2="4.5"/>
        <line x1="2" y1="9" x2="16" y2="9"/>
        <line x1="2" y1="13.5" x2="16" y2="13.5"/>
      </svg>
    </button>
  </div>
</header>

<div class="burger-backdrop" id="burgerBackdrop"></div>
<div class="burger-menu" id="burgerMenu">
  <div class="burger-inner">
    <div class="burger-row">
      <div class="burger-row-label">
        <span class="ico">üëÜ</span>
        <div><div>Swipe Gestures</div><div class="burger-row-sub">Left to skip ¬∑ Right to like</div></div>
      </div>
      <button class="toggle-sw on" id="swipeToggle" role="switch"></button>
    </div>
    <div class="burger-row">
      <div class="burger-row-label">
        <span class="ico">üåô</span>
        <div><div>Light Mode</div><div class="burger-row-sub">For the 3 people who actually want it</div></div>
      </div>
      <button class="toggle-sw" id="themeToggle" role="switch"></button>
    </div>
    <div class="burger-row" style="flex-direction:column;align-items:flex-start;">
      <div class="burger-row-label"><span class="ico">üìä</span><span>Today's Stats</span></div>
      <div class="streak-display" style="padding-left:32px;">
        <div class="streak-main">
          <span class="streak-fire">üî•</span>
          <span class="streak-num" id="streakCount">0</span>
          <span style="font-size:14px;"> articles today </span>
          <span class="streak-label" id="streakLabel"></span>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="sp-backdrop" id="spBackdrop"></div>
<div class="sp" id="settingsPanel">
  <div class="sp-hdr"><span>Settings</span><button class="sp-x" id="spClose">‚úï</button></div>

  <div class="sp-section">
    <div class="sp-section-title">Gestures</div>
    <div class="sp-row">
      <div class="sp-row-label">
        <span class="ico">üëÜ</span>
        <div><div>Swipe Gestures</div><div class="sp-row-sub">Left to skip ¬∑ Right to like</div></div>
      </div>
      <button class="toggle-sw on" id="dkSwipeToggle" role="switch"></button>
    </div>
  </div>

  <div class="sp-section">
    <div class="sp-section-title">Appearance</div>
    <div class="sp-row">
      <div class="sp-row-label">
        <span class="ico">üåô</span>
        <div><div>Light Mode</div><div class="sp-row-sub">For the 3 people who actually want it</div></div>
      </div>
      <button class="toggle-sw" id="dkThemeToggle" role="switch"></button>
    </div>
  </div>

  <div class="sp-section">
    <div class="sp-section-title">Beta Features</div>
    <div class="sp-row">
      <div class="sp-row-label">
        <span class="ico">üì≥</span>
        <div><div>Haptic Feedback <span class="beta-tag">Beta</span></div><div class="sp-row-sub">Vibrates on swiping (Limited iOS support)</div></div>
      </div>
      <button class="toggle-sw on" id="dkHapticToggle" role="switch"></button>
    </div>
    <div class="sp-row">
      <div class="sp-row-label">
        <span class="ico">üêá</span>
        <div><div>Rabbit Hole <span class="beta-tag">Beta</span></div><div class="sp-row-sub">Adds a "Go deeper" button for Wikipedia</div></div>
      </div>
      <button class="toggle-sw" id="dkRabbitToggle" role="switch"></button>
    </div>
    <div class="sp-row">
      <div class="sp-row-label">
        <span class="ico">‚å®Ô∏è</span>
        <div><div>Show Keyboard Hints</div><div class="sp-row-sub">Dynamic hint bar on desktop</div></div>
      </div>
      <button class="toggle-sw on" id="dkKbToggle" role="switch"></button>
    </div>
    <div class="sp-row">
      <div class="sp-row-label">
        <span class="ico">üî¨</span>
        <div><div>Article Depth <span class="beta-tag">Beta</span></div><div class="sp-row-sub">From popular (left) to deeply obscure (right)</div></div>
      </div>
    </div>
    <div class="sp-row" style="padding-top:0;border:none;">
      <div class="depth-wrap">
        <div class="depth-track">
          <input type="range" class="depth-slider" id="dkDepthSlider" min="1" max="5" value="3" step="1">
        </div>
        <div class="depth-steps" id="dkDepthSteps">
          <div class="depth-step" data-d="1"><div class="ds-dot"></div><span>Popular</span></div>
          <div class="depth-step" data-d="2"><div class="ds-dot"></div><span>Known</span></div>
          <div class="depth-step active" data-d="3"><div class="ds-dot"></div><span>Balanced</span></div>
          <div class="depth-step" data-d="4"><div class="ds-dot"></div><span>Niche</span></div>
          <div class="depth-step" data-d="5"><div class="ds-dot"></div><span>Obscure</span></div>
        </div>
      </div>
    </div>
  </div>

  <div class="sp-section">
    <div class="sp-section-title">Stats</div>
    <div class="sp-row" style="flex-direction:column;align-items:flex-start;gap:8px;">
      <div class="sp-row-label"><span class="ico">üìä</span><span>Today's Stats</span></div>
      <div class="streak-display" style="padding-left:32px;">
        <div class="streak-main">
          <span class="streak-fire">üî•</span>
          <span class="streak-num" id="dkStreakCount">0</span>
          <span style="font-size:14px;"> articles today </span>
          <span class="streak-label" id="dkStreakLabel"></span>
        </div>
      </div>
    </div>
  </div>

  <div class="sp-section">
    <div class="sp-section-title">About</div>
    <div class="sp-about">
      <div class="sp-about-logo">WikiScroll</div>
      <div class="sp-about-body">
        Infinite scrolling through Wikipedia and Wikivoyage in multiple languages.<br><br>
        Swipe right to like ¬∑ Left to skip.
      </div>
      <div class="sp-about-contact">contact [at] wikiscroll.com</div>
    </div>
  </div>
</div>

<div class="kb-bar" id="kbBar">
  <div class="kb-hint"><span class="kb-key">‚Üë</span><span class="kb-key">‚Üì</span> Scroll</div>
  <div class="kb-hint"><span class="kb-key">‚Üê</span><span class="kb-key">‚Üí</span> Swipe</div>
  <div class="kb-hint"><span class="kb-key">L</span> Like</div>
  <div class="kb-hint" id="kbDeeperHint" style="display:none"><span class="kb-key">D</span> Go Deeper</div>
  <div class="kb-hint" id="kbMapHint" style="display:none"><span class="kb-key">M</span> Map</div>
</div>

<div class="map-overlay" id="mapOverlay">
  <div class="map-container">
    <div class="map-hdr">
      <div class="map-title" id="mapTitle">Exploring‚Ä¶</div>
      <button class="map-close" id="mapClose">‚úï</button>
    </div>
    <div id="mapCanvas"></div>
  </div>
</div>

<div class="feed" id="feed" tabindex="0"></div>

<script>
'use strict';

let curMode = 'wiki', curLang = 'en';
let swipeEnabled = true, rabbitHoleEnabled = false, kbBarEnabled = true, hapticsEnabled = true;
let lightMode = false, depthLevel = 3;
let articles = [], queue = [];

function lsGet(k) { try { return JSON.parse(localStorage.getItem(k)); } catch { return null; } }
function lsSet(k, v) { try { localStorage.setItem(k, JSON.stringify(v)); } catch {} }

function loadSettings() {
  const settings = lsGet('ws_settings') || {};
  swipeEnabled = settings.swipe !== false;
  rabbitHoleEnabled = settings.rabbitHole === true;
  kbBarEnabled = settings.kbBar !== false;
  hapticsEnabled = settings.haptics !== false;
  lightMode = settings.lightMode === true;
  depthLevel = settings.depth || 3;
  document.body.classList.toggle('light', lightMode);
}

function saveSettings() {
  lsSet('ws_settings', { swipe: swipeEnabled, rabbitHole: rabbitHoleEnabled, kbBar: kbBarEnabled, haptics: hapticsEnabled, lightMode: lightMode, depth: depthLevel });
}

function doHaptic() {
  if (hapticsEnabled && navigator.vibrate) navigator.vibrate([40]);
}

function depthMinChars() {
  const map = {1:350, 2:200, 3:80, 4:50, 5:30};
  return map[depthLevel] || 80;
}

// Today's Stats Logic
function loadStats() {
  const s = lsGet('ws_stats') || { date:'', count:0, streak:0 };
  const today = new Date().toISOString().slice(0,10);
  if (s.date !== today) {
    const yesterday = new Date(); yesterday.setDate(yesterday.getDate()-1);
    const yKey = yesterday.toISOString().slice(0,10);
    s.streak = (s.date === yKey) ? s.streak + 1 : 1;
    s.date = today; s.count = 0; lsSet('ws_stats', s);
  }
  return s;
}
function bumpStat() {
  const s = loadStats(); s.count++; lsSet('ws_stats', s);
  syncStreakDisplay();
}
function syncStreakDisplay() {
  const s = loadStats();
  ['streakCount','dkStreakCount'].forEach(id => {
    const el = document.getElementById(id); if (el) el.textContent = s.count;
  });
  ['streakLabel','dkStreakLabel'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.textContent = s.streak > 1 ? `¬∑ ${s.streak}-day streak` : '';
  });
}

// Fetch Functions
async function fetchWiki() {
  const url = `https://${curLang}.wikipedia.org/api/rest_v1/page/random/summary`;
  const all = await Promise.all(Array.from({length:6}, () => fetch(url).then(r=>r.json()).catch(()=>null)));
  return all.filter(d => d?.thumbnail?.source && (d.extract?.length||0) >= depthMinChars()).slice(0,3).map(d => ({
    id: 'w'+d.pageid, src: 'wiki', title: d.title, body: d.extract, img: d.thumbnail.source, url: d.content_urls?.desktop?.page||'#'
  }));
}

async function fetchVoyage() {
  const url = `https://en.wikivoyage.org/api/rest_v1/page/random/summary`;
  const all = await Promise.all(Array.from({length:8}, () => fetch(url).then(r=>r.json()).catch(()=>null)));
  return all.filter(d => d?.thumbnail?.source && d.extract?.length > 40).slice(0,3).map(d => ({
    id: 'v'+d.pageid, src: 'how', title: d.title, body: d.extract, img: d.thumbnail.source, url: d.content_urls?.desktop?.page||'#'
  }));
}

async function fillQueue() {
  const fresh = curMode === 'wiki' ? await fetchWiki() : await fetchVoyage();
  queue.push(...fresh);
}

function flushQueue() {
  const batch = queue.splice(0, 3);
  batch.forEach(a => {
    const isHow = a.src === 'how';
    const card = document.createElement('div');
    card.className = 'card' + (isHow?' how':'');
    card.dataset.id = a.id;
    card.innerHTML = `
      <div class="cbg"><img src="${a.img}"><div class="cveil"></div></div>
      <div class="swipe-ind like-ind">‚ù§Ô∏è Like</div><div class="swipe-ind skip-ind">‚úï Skip</div>
      <div class="panel">
        ${isHow ? '<button class="top-map-btn" title="View on Map">üó∫Ô∏è</button>' : ''}
        <div class="chip ${isHow?'h':'w'}">${isHow?'üó∫Ô∏è Wikivoyage':'üìñ Wikipedia'}</div>
        <img src="${a.img}" class="art-img">
        <h2 class="art-title">${a.title}</h2>
        <p class="art-body">${a.body}</p>
        <div class="acts">
          <button class="act">ü§ç Like</button>
          ${rabbitHoleEnabled && !isHow ? '<button class="act">üêá Deeper</button>' : ''}
          <button class="act cta${isHow?' hcta':''}">${isHow?'üìã':'üìñ'} Read</button>
        </div>
      </div>`;
    
    if (isHow) {
      card.querySelector('.top-map-btn').addEventListener('click', () => openMap(a.title));
    }
    document.getElementById('feed').appendChild(card);
    bumpStat();
    articles.push(a);
  });
  updateKbHints();
  if (queue.length < 3) fillQueue();
}

// Swiping Logic
(function() {
  const feed = document.getElementById('feed');
  let startX=0, startY=0, curDx=0;
  let activeCard=null, swiping=false;

  function flyOff(card, dir) {
    if (dir > 0) doHaptic();
    const dist = dir > 0 ? 110 : -110;
    const rot = dir > 0 ? 8 : -8;
    card.style.transition = 'transform .45s cubic-bezier(.32,.94,.6,1), opacity .4s ease-out';
    card.style.transform = `translateX(${dist}vw) rotate(${rot}deg) translateZ(0)`;
    card.style.opacity = '0';
    
    setTimeout(() => {
      feed.scrollBy({top:window.innerHeight});
      setTimeout(()=> card.remove(), 100);
      updateKbHints();
    }, 300);
    flushQueue();
  }

  document.addEventListener('touchstart', ev => {
    activeCard = ev.target.closest('.card');
    if (!activeCard || ev.target.closest('button')) { activeCard = null; return; }
    startX=ev.touches[0].clientX; startY=ev.touches[0].clientY; swiping=false;
  },{passive:true});

  document.addEventListener('touchmove', ev => {
    if (!activeCard) return;
    const dx=ev.touches[0].clientX-startX, dy=ev.touches[0].clientY-startY;
    if (!swiping) { if(Math.abs(dx)>10) swiping=true; else return; }
    curDx=dx;
    if (swipeEnabled && ev.cancelable) {
      activeCard.style.transform = `translateX(${dx}px) rotate(${dx*0.035}deg)`;
      ev.preventDefault();
    }
  },{passive:false});

  document.addEventListener('touchend', ()=>{
    if (!activeCard||!swiping) return;
    if (swipeEnabled && Math.abs(curDx)>90) flyOff(activeCard, curDx>0?1:-1);
    else {
      activeCard.style.transition = 'transform .3s';
      activeCard.style.transform = '';
    }
    activeCard=null; swiping=false;
  },{passive:true});

  // Desktop Keyboard
  document.addEventListener('keydown', ev => {
    if (ev.target.closest('button,input')) return;
    const card = feed.querySelectorAll('.card')[Math.round(feed.scrollTop/window.innerHeight)];
    if (!card) return;
    if (ev.key === 'ArrowLeft') flyOff(card, -1);
    if (ev.key === 'ArrowRight') flyOff(card, 1);
    if (ev.key === 'm' || ev.key === 'M') {
      const a = articles.find(x => x.id === card.dataset.id);
      if (a && a.src === 'how') openMap(a.title);
    }
  });
})();

function updateKbHints() {
  const feed = document.getElementById('feed');
  const card = feed.querySelectorAll('.card')[Math.round(feed.scrollTop/window.innerHeight)];
  if (!card) return;
  const isHow = card.classList.contains('how');
  document.getElementById('kbDeeperHint').style.display = (!isHow && rabbitHoleEnabled) ? '' : 'none';
  document.getElementById('kbMapHint').style.display = isHow ? '' : 'none';
}

// Maps
async function openMap(title) {
  document.getElementById('mapTitle').textContent = title;
  document.getElementById('mapOverlay').classList.add('open');
  const q = encodeURIComponent(title.replace(/\s*\(.*?\)\s*/g, '').trim());
  try {
    const res = await fetch(`https://nominatim.openstreetmap.org/search?q=${q}&format=json&limit=1`);
    const data = await res.json();
    if(data.length) {
      const canvas = document.getElementById('mapCanvas');
      if(canvas._leaflet_id) { canvas._leaflet_id = null; canvas.innerHTML=''; }
      const map = L.map(canvas, {zoomControl:false}).setView([data[0].lat, data[0].lon], 10);
      L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);
      L.marker([data[0].lat, data[0].lon]).addTo(map).bindPopup(title).openPopup();
    }
  }catch(e){}
}
document.getElementById('mapClose').addEventListener('click', ()=>document.getElementById('mapOverlay').classList.remove('open'));

// Settings bindings
document.getElementById('settingsBtn').addEventListener('click', () => {
  document.getElementById('settingsPanel').classList.add('open');
  document.getElementById('spBackdrop').classList.add('open');
});
document.getElementById('spClose').addEventListener('click', () => {
  document.getElementById('settingsPanel').classList.remove('open');
  document.getElementById('spBackdrop').classList.remove('open');
});

document.getElementById('dkThemeToggle').addEventListener('click', () => { lightMode=!lightMode; saveSettings(); loadSettings(); });
document.getElementById('dkSwipeToggle').addEventListener('click', () => { swipeEnabled=!swipeEnabled; saveSettings(); });
document.getElementById('dkHapticToggle').addEventListener('click', () => { hapticsEnabled=!hapticsEnabled; saveSettings(); });
document.getElementById('dkRabbitToggle').addEventListener('click', () => { rabbitHoleEnabled=!rabbitHoleEnabled; saveSettings(); updateKbHints(); });
document.getElementById('dkKbToggle').addEventListener('click', () => { kbBarEnabled=!kbBarEnabled; saveSettings(); document.getElementById('kbBar').classList.toggle('show', kbBarEnabled); });

document.getElementById('wBtn').addEventListener('click', () => { curMode='wiki'; document.getElementById('wBtn').classList.add('won'); document.getElementById('hBtn').classList.remove('hon','on'); document.getElementById('feed').innerHTML=''; fillQueue().then(flushQueue); });
document.getElementById('hBtn').addEventListener('click', () => { curMode='how'; document.getElementById('hBtn').classList.add('hon','on'); document.getElementById('wBtn').classList.remove('won'); document.getElementById('feed').innerHTML=''; fillQueue().then(flushQueue); });

// Boot
loadSettings();
syncStreakDisplay();
fillQueue().then(flushQueue);
if ('serviceWorker' in navigator) navigator.serviceWorker.register('/sw.js');
</script>
</body>
</html>
